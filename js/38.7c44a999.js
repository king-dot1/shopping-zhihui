"use strict";(self["webpackChunkshopping"]=self["webpackChunkshopping"]||[]).push([[38],{2038:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"create"},[t("van-nav-bar",{attrs:{title:"新增收货地址","left-arrow":""},on:{"click-left":function(t){return e.$router.go(-1)}}}),t("div",{staticClass:"title"},[e._v("收货地址")]),t("van-form",{ref:"formInfo",attrs:{"validate-first":""},on:{submit:e.onSubmit,failed:e.onFailed}},[t("van-field",{staticClass:"field1",attrs:{label:"姓名",name:"name",placeholder:"请输入收货人姓名",rules:e.formRyles.name},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t("van-field",{attrs:{label:"电话",name:"mobile",placeholder:"请输入收货人手机号",rules:e.formRyles.mobile},model:{value:e.mobile,callback:function(t){e.mobile=t},expression:"mobile"}}),t("van-field",{attrs:{rules:e.formRyles.area,readonly:"",clickable:"",name:"area",value:e.area,label:"地区选择",placeholder:"请选择省/市/区"},on:{click:function(t){e.showArea=!0}}}),t("van-popup",{attrs:{position:"bottom"},model:{value:e.showArea,callback:function(t){e.showArea=t},expression:"showArea"}},[t("van-area",{attrs:{"area-list":e.areaList1},on:{confirm:e.onConfirm,cancel:function(t){e.showArea=!1}}})],1),t("van-field",{staticClass:"field2",attrs:{label:"详细地址",name:"detail",placeholder:"街道门牌、楼层等信息",rules:e.formRyles.detail},model:{value:e.detail,callback:function(t){e.detail=t},expression:"detail"}}),t("div",{staticStyle:{margin:"16px"}},[t("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"}},[e._v("提交")])],1)],1)],1)},i=[],r=a(2776),s=a(5882),o={name:"createPage",mixins:[s.A],data(){return{}},async created(){try{await this.getRegionTree(),this.getRegionTreeHandler(this.$store.state.address.list)}catch(e){console.error(e)}},methods:{async onSubmit(){await(0,r.Wd)(this.name,this.mobile,this.region,this.detail),this.$router.go(-1)}}},l=o,d=a(1656),c=(0,d.A)(l,n,i,!1,null,"29caf0ae",null),u=c.exports},2776:function(e,t,a){a.d(t,{Bf:function(){return i},Re:function(){return r},Wd:function(){return s},Z8:function(){return c},aX:function(){return u},h5:function(){return l},p1:function(){return d},y9:function(){return o}});var n=a(5720);const i=()=>n.A.get("/region/tree"),r=()=>n.A.get("/address/list"),s=(e,t,a,i)=>n.A.post("/address/add",{form:{name:e,phone:t,region:a,detail:i}}),o=e=>n.A.get("/address/detail",{params:{addressId:e}}),l=(e,t)=>{const{name:a,phone:i,region:r,detail:s}=t;return n.A.post("/address/edit",{addressId:e,form:{name:a,phone:i,region:r,detail:s}})},d=e=>{n.A.post("/address/remove",{addressId:e})},c=()=>n.A.get("/address/defaultId"),u=e=>{n.A.post("/address/setDefault",{addressId:e})}},5882:function(e,t,a){a(8111),a(2489),a(116),a(7588),a(1701);var n=a(2776);t.A={data(){return{name:"",mobile:"",region:[],area:"",detail:"",showArea:!1,areaList1:{province_list:{},city_list:{},county_list:{}},areaList2:[],formRyles:{name:[{required:!0,message:"请输入名字"}],mobile:[{required:!0,message:"请填手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确手机号"}],area:[{required:!0,message:"请选择地区"}],detail:[{required:!0,message:"请输入详细地址"}]}}},methods:{onFailed(e){this.$toast(e.errors[0].message)},onConfirm(e){const t=this.areaList2.find((t=>t.code===e[0].code)),a=t.children.find((t=>t.code===e[1].code)),n=a.children.find((t=>t.code===e[2].code));this.region=[{value:t.value,label:t.name},{value:a.value,label:a.name},{value:n.value,label:n.name}],this.area=e.filter((e=>!!e)).map((e=>e.name)).join("/"),this.showArea=!1},async getRegionTree(){const e=this.$store.state.address.list;if(Object.keys(e).length>0)return void this.getRegionTreeHandler(e);const{data:{list:t}}=await(0,n.Bf)();this.$store.commit("address/setRegionTreeMutation",t)},async getRegionTreeHandler(e){const t=Object.keys(e);t.forEach(((t,a)=>{const n=e[t],i=(10+a).toString().padEnd(6,"0");if(this.areaList1.province_list[i]=n.name,this.areaList2[a]={code:i,value:n.id,name:n.name,children:[]},n.city){const e=Object.keys(n.city);e.forEach(((e,t)=>{const i=n.city[e],r=(10+a).toString()+(t+1).toString().padStart(2,"0")+"00";if(this.areaList1.city_list[r]=i.name,this.areaList2[a].children[t]={code:r,value:i.id,name:i.name,children:[]},i.region){const e=Object.keys(i.region);e.forEach(((e,n)=>{const r=i.region[e],s=(10+a).toString()+(t+1).toString().padStart(2,"0")+(n+1).toString().padStart(2,"0");this.areaList1.county_list[s]=r.name,this.areaList2[a].children[t].children[n]={code:s,value:r.id,name:r.name}}))}}))}}))}}}}}]);
//# sourceMappingURL=38.7c44a999.js.map